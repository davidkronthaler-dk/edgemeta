---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->
<!-- README.Rmd needs to be rendered to MD with devtools::build_readme() -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# metaprediction

<!-- badges: start -->
<!-- badges: end -->

The `metaprediction` package provides methods to construct frequentist predictive distributions in random-effects meta-analysis using confidence distributions. 

The package introduces the S3 class `metaprediction`. The methods are implemented in the C++ programming language to ensure computational efficiency and are made available in the R environment using the Rcpp interface. 

The methods assumes that future effects and effects from observed studies are exchangeable and distributed according to a normal distribution. The Edgington combined $p$-value function is used to construct a confidence distribution for the average effect, and the generalized heterogeneity statistic is used to construct a confidence distribution for the heterogeneity parameter.

The considered predictive distributions are then constructed by marginalizing the normal effect distribution over the latter confidence distributions to account for uncertainty in the estimation. The predictive distributions are computed using a Monte Carlo sampling algorithm, also yielding an estimator for the average effect, which accounts for uncertainty in the heterogeneity estimate.

## Installation

You can install the development version of `metaprediction` from [GitHub](https://github.com/) with:

``` r
# install.packages("remotes")
remotes::install_github("davidkronthaler-dk/metaprediction")
# or
# install.packages("devtools")
devtools::install_github("davidkronthaler-dk/metaprediction")
```

## Example

The `PredDist` function constructs an object of class `metaprediction`. Generic S3 methods (such as print, summary, or plot) are applicable. The function `PredDist` requires minimal input: a numeric vector of effect estimates, a corresponding vector of standard errors, and a string specifying the desired method. In case exact reproducibility of the result is required, a seed can be additionally set to ensure the latter.

Assume observed data (estimates and standard errors) from *k = 5* independent studies. A frequentist predictive distribution can be computed using:

```{r example predictive distribution}
library(metaprediction)

# Estimates and standard errors from 5 studies
es <- c(1.17,  2.20,  1.10, -0.0019, -1.33) 
se <- c(0.52, 0.93, 0.63, 0.3, 0.28)

# Computation of predictive distribution
pd <- PredDist(es = es, se = se, method = "FullCD")

# 95% prediction interval
pd$PI

# Plot the predictive distribution
plot(pd, param = "theta_new", breaks = 200, xlim = c(-7, 7))

# Futher information: 'help(PredDist)'
```

The `remaeffect` function can be used to estimate the average effect $\mu$ and its confidence interval, which incorporates the uncertainty in the estimation of the between-study heterogeneity:

```{r example average effect}
# Average effect and confidence interval
me <- remaeffect(es = es, se = se)
me$estimate
me$CI

# Further information: 'help(remaeffect)'
```

