% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/remaeffect.R
\name{remaeffect}
\alias{remaeffect}
\title{Estimate the Average Effect in Random-Effects Meta-Analysis via Edgington's Confidence Distribution}
\usage{
remaeffect(
  es,
  se,
  method = c("MC", "GAQ", "NHEU"),
  level.ci = 0.95,
  n_samples = 100000L,
  seed = NULL,
  mu0 = 0
)
}
\arguments{
\item{es}{Numeric vector of effect estimates from individual studies (length >= 2).}

\item{se}{Numeric vector of standard errors corresponding to each effect estimate (length >= 2).}

\item{method}{Either "MC" for Monte Carlo sampling algorithm, "GAQ" for global adaptive quadrature integration, or "NHEU" for the unadjusted (unmarginalized) approach.}

\item{level.ci}{Confidence level for the interval estimate (default is 0.95).}

\item{n_samples}{Number of Monte Carlo samples used to estimate the confidence distributions (default is 100,000).}

\item{seed}{Optional integer to ensure reproducibility of the random sampling, relevant in case method 'MC' is chosen.}

\item{mu0}{Parameter value under the null-hypothesis against which two-sided p-value is computed.}
}
\value{
A list, including not all, but some of these, depending on the method:
\describe{
\item{estimate}{Point estimate of the average effect \eqn{\mu}.}
\item{CI}{Confidence interval for the average effect \eqn{\mu}.}
\item{pval}{Two-sided p-value against H0: \eqn{\mu} = \eqn{\mu_0}.}
\item{cd_mu}{Vector of samples from the confidence distribution of the average effect \eqn{\mu}.}
\item{cd_tau2}{Vector of samples from the confidence distribution of the between-study heterogeneity \eqn{\tau^2}.}
\item{fcd}{Obtained for method 'GAQ': Marginalized confidence density function of \eqn{\mu}.}
}
}
\description{
Estimates the average effect in random-effects meta-analysis using Edgingtons Confidence Distribution.
Confidence distributions for the average effect \eqn{\mu}, or equivalently, \eqn{p}-value functions, from individual studies
are combined using Edgington's approach. The resulting combined confidence distribution of \eqn{\mu},
which is conditional on the heterogeneity parameter \eqn{\tau^2}, is marginalized over a confidence distribution of the latter
to account for estimation uncertainty. Alternatively, the approach can be performed without such marginalization using a fixed
heterogeneity estimate.
}
\details{
This function performs a random-effects meta-analysis using confidence distributions.
It generates samples from the confidence distribution of the between-study heterogeneity \eqn{\tau^2},
derived from the generalized heterogeneity statistic (Viechtbauer, 2006). For each sampled value of \eqn{\tau^2},
the function then computes a corresponding confidence distribution for the average
effect \eqn{\mu}, induced by the Edgington combined p-value function (Held et al., 2025), and generates a sample from
this distribution.

By repeatedly sampling \eqn{\tau^2} and recalculating the confidence distribution of \eqn{\mu},
the method incorporates the uncertainty in heterogeneity estimation into the final
average effect estimate. The function returns the point estimate, its confidence
interval, and the full sample of values drawn from the confidence distributions.

Since the method accounts for the uncertainty in \eqn{\tau^2}, it always returns a
confidence interval that adjusts for potential between-study heterogeneity,
that is, the framework of a fixed-effects meta-analysis is not applicable.
}
\examples{
es <- c(0.17,  1.20,  1.10, -0.0019, -2.33)
se <- c(0.52, 0.93, 0.63, 0.3, 0.28)
remaeffect(es = es, se = se)



}
\references{
Viechtbauer, W. (2007). \emph{Confidence intervals for the amount of heterogeneity in meta‐analysi}s. Statistics in medicine, 26(1), 37-52. https://doi.org/10.1002/sim.2514

Held, L., Hofmann, F., & Pawel, S. (2025). \emph{A comparison of combined p-value functions for meta-analysis}. doi:10.1017/rsm.2025.26
}
\author{
David Kronthaler
}
